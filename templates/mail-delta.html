{% macro render_delta(
    subject=None,
    predicate=None,
    object=None,
    default_value="onbekend",
    all_format="{}",
    unchanged_format="{}",
    deleted_format="<del>{}</del>",
    inserted_format="<ins>{}</ins>"
) %}
    {# This is ugly, but it's what the docs suggest... #}
    {% set ns = namespace(printed=false) %}

    {% for unchanged_part in unchanged[subject:predicate:object] %}
        {{ unchanged_format.format(all_format.format(unchanged_part)) | safe }}
        {% set ns.printed = true %}
    {% endfor %}

    {% for deleted_part in deletes[subject:predicate:object] %}
        {{ deleted_format.format(all_format.format(deleted_part)) | safe }}
        {% set ns.printed = true %}
    {% endfor %}

    {% for inserted_part in inserts[subject:predicate:object] %}
        {{ inserted_format.format(all_format.format(inserted_part)) | safe }}
        {% set ns.printed = true %}
    {% endfor %}

    {% if not ns.printed and default_value %}
        {{ default_value }}
    {% endif %}
{%- endmacro %}

<html>
    <body>
        {{ render_delta(agendapunt, DCTERMS.title, all_format="<h1>{}</h1>") }}

        {{ render_delta(
            subject=agendapunt,
            predicate=OWL.sameAs,
            unchanged_format="<a href=\"{}\">Externe link</a>",
            deleted_format="<a href=\"{}\">Oude link</a>",
            inserted_format="<a href=\"{}\">Nieuwe link</a>",
            default_value=None
        ) }}

        {% if stemming %}
            Stemming{{render_delta(
                stemming,
                BESLUIT.gevolg,
                default_value="",
                all_format=" <b>{}</b>"
            ) }}:
            <ul>
                <li> voor: {{render_delta(
                    stemming,
                    BESLUIT.aantalVoorstanders
                )}} </li>
                <li> tegen: {{render_delta(
                    stemming,
                    BESLUIT.aantalTegenstanders
                )}} </li>
                <li> onthouding: {{render_delta(
                    stemming,
                    BESLUIT.aantalOnthouders
                )}} </li>
            </ul>
        {% endif %}

        {% if zitting %}
        <h2> Zitting {{ render_delta(
            zitting,
            PROV.startedAtTime,
            default_value=""
        ) }} </h2>
            Gepland op: {{ render_delta(zitting, BESLUIT.geplandeStart) }} <br>
            Locatie: {{ render_delta(zitting, PROV.atLocation) }} <br>

            {% if zitting_notulen %}
                {{ render_delta(
                    zitting_notulen,
                    OWL.sameAs,
                    all_format="Notulen: <a href=\"{}\">link</a>"
                ) }}
            {% else %}
                Notulen: onbekend
            {% endif %}
            <br>
        {% endif %}
    </body>
</html>
